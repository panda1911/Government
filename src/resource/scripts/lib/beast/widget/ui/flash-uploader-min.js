("Uploader" in jQuery.ui.flash)||(function(b,e){var d=b.util,a=b.isArray,c=function(){var r=this,k=r.element[0].id,n=d.ua.ie67,g=r.options;g=r.options=b.extend(true,{width:65,height:22,inputName:"imgFile",fileFilters:[{description:"ͼƬ(*.jpg, *.jpeg, *.gif, *.png, *.bmp)",extensions:"*.jpg;*.jpeg;*.gif;*.png;*.bmp;"}],flashvars:{buttonSkin:"http://img.china.alibaba.com/cms/upload/2011/040/820/28040_548721671.gif",eventHandler:"jQuery.util.flash.triggerHandler"}},g);if(g.flash||(d.ua.ie&&d.flash.hasVersion(10))){g=r.options=b.extend(true,{swf:"http://img.china.alibaba.com/swfapp/aliuploader/aliuploader-v2.7.swf",allowscriptaccess:"always",flashvars:{dataTimeoutDelay:60,allowSimul:true,simUploadLimit:1,sizeLimitEach:0,sizeLimitTotal:0,allowCompress:false,compressQuality:80,compressSize:0,compressWidth:800,compressHeight:800,allowMultiple:false,fileNumLimit:1,startDelay:500}},g);if(g.fileFilters){r.element.bind("interfaceReady.flash",function(s,o){r.obj.setFileFilters(g.fileFilters)})}b.extend(r,{_getFlashConfigs:function(){var o=this,s;s=b.ui.flash.prototype._getFlashConfigs.call(o);delete s.flash;delete s.fileFilters;delete s.inputName;s.flashvars.swfid=k;return s},_setOption:function(s,t){var o=this;b.ui.flash.prototype._setOption.call(o,s,t);if(s==="fileFilters"&&a(t)){o.obj.setFileFilters(t)}return this},uploadAll:function(t,v){var s=this,u=s.options;if(t.indexOf("?")<0){t+="?_input_charset=UTF-8"}else{t+="&_input_charset=UTF-8"}s.obj.uploadAll(t,"POST",v,u.inputName);return s},getFileStatus:function(){return this.obj.getFileStatus()},clearFileList:function(){this.obj.clearFileList();return this},setFileCountLimit:function(o){this.obj.setFileCountLimit(o);return this},disable:function(){r.obj.disable();return this._setOption("disabled",true)},enable:function(){r.obj.enable();return this._setOption("disabled",false)}});return true}else{var q=b.guid++,j=new Function("return "+g.flashvars.eventHandler)(),p=b("<div>",{"class":"ui-flash-uploader"}).appendTo(document.body).html('<form action="" enctype="multipart/form-data" method="post" target="proxy'+q+'"></form><iframe width="0" height="0" frameborder="0" name="proxy'+q+'" src="about:blank"></iframe>'),f=b("form",p),m=b("iframe",p),i=[],h,l;if(g.flashvars.eventHandler){m.bind("load",function(s){try{if(this.contentWindow.location.href==="about:blank"||this.contentWindow.location.host!==location.host){return}else{j({swfid:k,type:"uploadCompleteData",id:h,fileName:l,data:b.unparam(this.contentWindow.location.href)});i[0].status="done";j({swfid:k,type:"finish"})}}catch(o){}})}b.extend(r,{uploadAll:function(v,x){var t=this,w=t.options,y=v.lastIndexOf("?")>-1;x=x||{};f.attr({action:v+(y?"&":"?")+"redirectUrl=http://"+location.host+"/crossdomain.xml&"});for(var u in x){var s=n?document.createElement('<input type="text" name="'+u+'">'):b("<input>",{type:"text",name:u})[0];s.value=x[u];f.append(s)}i[0]={id:h,name:l,status:"uploading"};j({swfid:k,type:"uploadStart",id:h,fileName:l});f.submit();return t},getFileStatus:function(){return i},clearFileList:function(){i.length=0;return this},setFileCountLimit:function(o){return this},disable:function(){b("input",this.element).prop("disabled",true);return this._setOption("disabled",true)},enable:function(){b("input",this.element).prop("disabled",false);return this._setOption("disabled",false)},_destroy:function(){var o=this;p.remove();b.ui.flash.prototype._destroy.call(o)},_render:function(){var v=r.element,w=r.options;v.html('<div><input type="file" name="'+w.inputName+'" hidefocus="true" autocomplete="off"/><a href="javascript:;">&nbsp;</a></div>');var s=b(">div",v).css({width:w.width,height:w.height}),u=b(">input",s),t=b(">a",s).css({width:w.width,height:w.height,"background-image":"url("+w.flashvars.buttonSkin+")"});u.hover(function(){t.addClass("ui-state-hover")},function(){t.removeClass("ui-state-hover")}).bind("change",function(x){h="file"+b.guid++;l=u.val().split("\\").pop();if(a(w.fileFilters)){var o="";b.each(w.fileFilters,function(y,z){o+=z.extensions});if(o.slice(-1)===";"){o=o.slice(0,-1)}if(!(new RegExp(o.replace(/\*\./g,"").replace(/;/g,"|")+"$","i").test(this.value))){if(w.flashvars.eventHandler){j({swfid:k,type:"uploadCompleteData",id:h,fileName:l,data:{result:"fail",errCode:["TYPEERR"],errMsg:["TYPEERR"]}});j({swfid:k,type:"finish"})}t.removeClass("ui-state-hover");return}}f.empty().append(u);t.removeClass("ui-state-hover");r._render();i[0]={id:h,name:l,status:"ready"};v.trigger("fileSelect",{swfid:k,numFiles:1,filesRefused:[],fileList:[{id:h,name:l}]})})}});r._render();setTimeout(function(){j({swfid:k,type:"interfaceReady"})},0);return false}};d.flash.regist("uploader",c);b.add("ui-flash-uploader")})(jQuery);